/*
hoverplus lightweight pop-up window on mouse-over
@author  Levente Hunyadi
@version 1.5.0
@remarks Copyright (C) 2011 Levente Hunyadi
@see     http://hunyadi.info.hu/projects/hoverplus
*/
'use strict';(function(v){function f(a){return"hoverplus-"+a}function q(a){a.addClass(f("hidden"))}function r(a){a.removeClass(f("hidden"))}var w=new Class({initialize:function(){this._dialog=(new Element("div",{id:"hoverplus"})).adopt(this._viewer=new Element("div",{"class":f("viewer")}),this._caption=(new Element("div",{"class":f("caption")})).adopt(this._title=new Element("p",{"class":f("title")}),this._text=new Element("p",{"class":f("text")}))).inject(document.body);q($$([this._dialog,this._viewer,
this.caption]))},show:function(a,e,c,h){function m(b,h){var g=a.getCoordinates(),m=window.getScroll(),c=g.left-m.x,d=g.top-m.y,f=g.width;g=g.height;for(var e=window.getSize(),l=[c+f+b-e.x,d+g+h-e.y,b-c,h-d],t=-1,k=Infinity,n=0;n<l.length;n++)l[n]<k&&(t=n,k=l[n]);l=c+(f-b)/2;k=e.x-b-20;l>k&&(l=k);20>l&&(l=20);k=d+(g-h)/2;e=e.y-h-20;k>e&&(k=e);20>k&&(k=20);return{left:m.x+[c+f+20,l,c-b-20,l][t],top:m.y+[k,d+g+20,k,d-h-20][t]}}var b=this;(new Fx.Morph(b._dialog)).set("."+f("dialog"));b._dialog.setStyles(m(0,
0));r(b._dialog);q($$([b._viewer,b._caption]));var d=v(new Image).addEvents({load:function(){var a=d.width,f=d.height,g={width:a,height:f};b._viewer.setStyles(Object.append({"background-image":'url("'+e+'")'},g));b._caption.setStyle("width",a);a=Object.append(m(a,f),g);(new Fx.Morph(b._dialog,{duration:200,onComplete:function(){r(b._viewer);b._title.empty().set("html",c);b._text.empty().set("html",h);if(c||h)g.height+=b._caption.getSize().y,(new Fx.Morph(b._dialog,{duration:100,onComplete:function(){r(b._caption)}})).start(g)}})).start(a)},
error:function(){b.hide()}}).setProperty("src",e)},hide:function(){q(this._dialog)}}),u;window.addEvent("domready",function(){u=new w});var p=new Class({Implements:Options,options:{getTitle:function(a){return(a=a.getElement("img"))?a.getProperty("alt"):""},getText:function(a){return a.getProperty("title")}},initialize:function(a,e,c){function h(){d&&clearTimeout(d);d=m.delay(100,b)}function m(){d&&clearTimeout(d);a.removeEvent("mousemove",h);u.show(a,e,c.getTitle(a),c.getText(a))}var b=this;b.setOptions(c);
c=b.options;var d;a.addEvents({mouseenter:function(){a.addEvent("mousemove",h);h()},mouseleave:function(){a.removeEvent("mousemove",h);d&&clearTimeout(d);u.hide()}})}});p.bind=function(a,e){function c(a){a.each(function(a){/\.(jpe?g|png|gif)$/i.test(a.getProperty("href"))&&new p(a,a.getProperty("href"),e)})}if(a.length&&a.get("tag").every(function(a){return"a"==a}))c(a);else switch(a.get("tag")){case "ol":case "ul":a.getChildren("li").each(function(a){c(a.getChildren("a[href]"));a.getChildren("img").each(function(a){new p(a,
a.getProperty("src"),e)})})}};window.hoverplus=p})(document.id);
